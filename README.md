Most of the equations are from 
https://www2.aueb.gr/users/ion/docs/ceas2006_paper.pdf
